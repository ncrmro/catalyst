# Default values for catalyst chart
# This is a YAML-formatted file.

# Values for Istio base subchart
istio-base:
  # Base is required for CRDs and core Istio resources
  enabled: true
  global:
    # Configure Istio to use the same namespace as the chart installation
    istioNamespace: catalyst-system

# Values for istiod subchart (control plane)
istiod:
  enabled: true
  global:
    # Configure Istio to use the same namespace as the chart installation
    istioNamespace: catalyst-system
  meshConfig:
    # Enable mTLS in STRICT mode for all workloads in the mesh
    defaultConfig:
      proxyMetadata: {}
    # Enforce mTLS for all service-to-service communication
    enableAutoMtls: true
  pilot:
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 500m
        memory: 512Mi

# Values for ingress-nginx subchart
ingress-nginx:
  controller:
    service:
      type: LoadBalancer
    ingressClassResource:
      default: true

# Values for cert-manager subchart
cert-manager:
  installCRDs: true

# Values for CloudNativePG subchart
cloudnative-pg:
  crds:
    create: false # CRDs are managed in chart's crds/ directory via scripts/update-crds.sh

# PostgreSQL Cluster configuration for the web database
postgresql:
  enabled: true
  name: catalyst-db
  instances: 1
  storage:
    size: 10Gi
    storageClass: ""
  database: catalyst
  owner: catalyst
  resources:
    requests:
      memory: 256Mi
      cpu: 100m
    limits:
      memory: 1Gi
      cpu: 500m

# Operator configuration
operator:
  enabled: true
  replicaCount: 1

  image:
    repository: ghcr.io/ncrmro/catalyst/operator
    tag: latest
    pullPolicy: IfNotPresent

  imagePullSecrets: []

  resources:
    limits:
      cpu: 500m
      memory: 128Mi
    requests:
      cpu: 10m
      memory: 64Mi

  nodeSelector: {}
  tolerations: []
  affinity: {}

# Web application configuration
web:
  enabled: true
  replicaCount: 1

  image:
    repository: ghcr.io/ncrmro/catalyst/web
    tag: latest
    pullPolicy: IfNotPresent

  imagePullSecrets: []

  service:
    type: ClusterIP
    port: 3000

  ingress:
    enabled: false
    className: nginx
    annotations: {}
    hosts:
      - host: catalyst.local
        paths:
          - path: /
            pathType: Prefix
    tls: []

  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 128Mi

  env: []

  envFrom: []

  livenessProbe:
    httpGet:
      path: /api/health/readiness
      port: http
    initialDelaySeconds: 10
    periodSeconds: 10

  readinessProbe:
    httpGet:
      path: /api/health/readiness
      port: http
    initialDelaySeconds: 5
    periodSeconds: 5

  nodeSelector: {}
  tolerations: []
  affinity: {}
