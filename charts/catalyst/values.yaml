# Default values for catalyst chart
# This is a YAML-formatted file.

# Values for ingress-nginx subchart
ingress-nginx:
  controller:
    service:
      type: LoadBalancer
    ingressClassResource:
      default: true

# Values for cert-manager subchart
cert-manager:
  installCRDs: true

# Values for CloudNativePG subchart
cloudnative-pg:
  crds:
    create: false # CRDs are managed in chart's crds/ directory via scripts/update-crds.sh

# PostgreSQL Cluster configuration for the web database
postgresql:
  enabled: true
  name: catalyst-db
  instances: 1
  storage:
    size: 10Gi
    storageClass: ""
  database: catalyst
  owner: catalyst
  resources:
    requests:
      memory: 256Mi
      cpu: 100m
    limits:
      memory: 1Gi
      cpu: 500m

# Operator configuration
operator:
  enabled: true
  replicaCount: 1

  image:
    repository: ghcr.io/ncrmro/catalyst/operator
    tag: latest
    pullPolicy: IfNotPresent

  imagePullSecrets: []
  podAnnotations: {}

  # Preview routing configuration
  previewDomain: ""           # Required for production, e.g. "preview.catalyst.dev"
  localPreviewRouting: false  # When true, uses http://{namespace}.localhost:{ingressPort}
  ingressPort: ""             # Port for local preview routing (e.g. "8080")
  ingressNamespace: ""        # Namespace where ingress controller runs (default: "ingress-nginx")

  resources:
    limits:
      cpu: 500m
      memory: 128Mi
    requests:
      cpu: 10m
      memory: 64Mi

  nodeSelector: {}
  tolerations: []
  affinity: {}

  logLevel: info

  # Git clone image used for development mode init containers
  # Pinned by SHA256 digest for reproducibility (alpine/git:2.45.2)
  gitCloneImage: "alpine/git@sha256:16ad8e788e1d3b0c30f18da8dde5c0ace3b187445a62d8af893b003ca1e70592"

# Web application configuration
web:
  enabled: true
  replicaCount: 1

  image:
    repository: ghcr.io/ncrmro/catalyst/web
    tag: latest
    pullPolicy: IfNotPresent

  imagePullSecrets: []
  podAnnotations: {}

  service:
    type: ClusterIP
    port: 3000

  ingress:
    enabled: false
    className: nginx
    annotations: {}
    hosts:
      - host: catalyst.local
        paths:
          - path: /
            pathType: Prefix
    tls: []

  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 128Mi

  # Enable PAT mode for git-token endpoint (for users using GitHub PAT instead of App)
  enableGitTokenPatMode: false

  env: []

  envFrom: []

  livenessProbe:
    httpGet:
      path: /api/health/readiness
      port: http
    initialDelaySeconds: 10
    periodSeconds: 10

  readinessProbe:
    httpGet:
      path: /api/health/readiness
      port: http
    initialDelaySeconds: 5
    periodSeconds: 5

  nodeSelector: {}
  tolerations: []
  affinity: {}
