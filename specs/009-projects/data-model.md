# Data Model: Projects Management

## Entities

### 1. Project (Extended)
*Existing table `projects` needs status field.*

- `id`: UUID (PK)
- `name`: Text
- `slug`: Text (Unique per team)
- `status`: Enum (`active`, `archived`, `suspended`) - **NEW**
- `teamId`: UUID (FK to teams)
- `repositoryId`: UUID (FK to repos)

### 2. ProjectAgent
*Configuration for AI agents enabled on a project.*

- `id`: UUID (PK)
- `projectId`: UUID (FK to projects)
- `type`: Enum (`platform`, `project`, `qa`)
- `enabled`: Boolean
- `config`: JSONB (custom settings like retry count, approved paths)
- `lastRunAt`: Timestamp
- `status`: Enum (`idle`, `running`, `failed`)

### 3. ProjectSpec
*Indexed specification files.*

- `id`: UUID (PK)
- `projectId`: UUID (FK to projects)
- `path`: Text (file path in repo)
- `hash`: Text (content hash)
- `title`: Text
- `lastSyncedAt`: Timestamp

### 4. WorkItem
*Unified representation of issues, PRs, or tasks.*

- `id`: UUID (PK)
- `projectId`: UUID (FK to projects)
- `sourceId`: Text (GitHub Issue ID, PR ID, or Agent Task ID)
- `type`: Enum (`issue`, `pr`, `task`)
- `category`: Enum (`feature`, `platform`, `bug`, `chore`)
- `title`: Text
- `status`: Text
- `priorityScore`: Integer (calculated)
- `createdAt`: Timestamp

### 5. PrioritizationRule
*Rules for ranking work items.*

- `id`: UUID (PK)
- `projectId`: UUID (FK to projects)
- `name`: Text
- `condition`: JSONB (logic for applying rule)
- `weight`: Integer (impact on score)

### 6. ProjectAgentTask
*Tasks generated by agents.*

- `id`: UUID (PK)
- `agentId`: UUID (FK to projectAgents)
- `title`: Text
- `description`: Text
- `status`: Enum (`pending`, `in_progress`, `completed`, `failed`)
- `result`: JSONB

### 7. ProjectAgentApprovalPolicy
*Approval rules for agent actions.*

- `id`: UUID (PK)
- `projectId`: UUID (FK to projects)
- `agentType`: Enum (`platform`, `project`, `qa`)
- `actionType`: Text
- `requireApproval`: Boolean
- `autoApproveConditions`: JSONB

## Relationships

- Project 1:N ProjectAgent
- Project 1:N ProjectSpec
- Project 1:N WorkItem
- Project 1:N PrioritizationRule
- ProjectAgent 1:N ProjectAgentTask
- Project 1:N ProjectAgentApprovalPolicy